# ==========================
# Application
# ==========================
spring.application.name=backend
spring.thymeleaf.check-template-location=false

# ==========================
# Database connection - Docker/Production friendly ENV with defaults
# ==========================
spring.datasource.url=jdbc:mariadb://${DB_HOST:localhost}:${DB_PORT:3306}/${DB_NAME:bidgallery}
spring.datasource.username=${DB_USER:root}
spring.datasource.password=${DB_PASSWORD:toor}
spring.datasource.driver-class-name=org.mariadb.jdbc.Driver

# ==========================
# JPA / Hibernate
# ==========================
# Hibernate creates tables automatically
spring.jpa.hibernate.ddl-auto=${HIBERNATE_DDL_AUTO:create}
# Hide SQL logs (set to true for debugging)    
spring.jpa.show-sql=false                   
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.defer-datasource-initialization=true
# Disable Open-in-View warning
spring.jpa.open-in-view=false               

# ==========================
# SQL initialization
# =========================='
# Ensures data.sql is executed
spring.sql.init.mode=always                 
spring.sql.init.encoding=UTF-8
# Continue even if some statements fail
spring.sql.init.continue-on-error=true      

# ==========================
# JSON / Enums
# ==========================
spring.jackson.mapper.accept-case-insensitive-enums=true

# ==========================
# JWT configuration
# ==========================
jwt.secret=wR8x!vP9sK2tM4uH1qL5jF3oZ6eN7rY0bG9aD2cS1kL8pV0xB3yH5mQ7tW9uR2fX
jwt.expiration-ms=86400000

# ==========================
# Logging
# ==========================
logging.level.org.hibernate.SQL=ERROR
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=ERROR

# ================= Monitoring==========
# Actuator endpoints
management.endpoints.web.exposure.include=health,info,metrics,prometheus,loggers
management.metrics.enable.all=true
management.metrics.export.prometheus.enabled=true
management.endpoint.metrics.enabled=true
management.endpoint.prometheus.enabled=true
management.endpoint.health.show-details=always
management.endpoint.health.enabled=true

# Logging levels with environment override
logging.level.root=${LOG_LEVEL_ROOT:INFO}
logging.level.dk.dtu.backend=${LOG_LEVEL_APP:INFO}

# Custom metric tags
management.metrics.tags.application=bidgallery-backend
management.metrics.tags.environment=${APP_ENV:development}

# Logging pattern for non-JSON (optional)
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - [correlationId:%X{correlationId}, user:%X{userEmail}] - %msg%n

# ==========================
# Server
# ==========================
server.port=${PORT:8080}