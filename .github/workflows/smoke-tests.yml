name: Smoke Tests

on:
  workflow_run:
    workflows: ["Deploy Frontend", "Deploy Backend"]
    types: [completed]

jobs:
  smoke-tests:
    if: ${{ github.event.workflow_run.conclusion == 'success' }}
    runs-on: ubuntu-latest
    steps:
    - name: Test frontend
      run: curl -f https://frontend.yourdomain.com/ || exit 1
      
    - name: Test backend API
      run: curl -f https://api.yourdomain.com/actuator/health || exit 1
      
    - name: Test database connection
      run: |
        response=$(curl -s https://api.yourdomain.com/actuator/health)
        echo $response | grep '"status":"UP"' || exit 1
        
    - name: Deployment success
      run: echo "ðŸŽ‰ All services deployed and healthy!"